<div class="modal-task">
	<div class="modal-task__close" (click)="onNoClick()">
		<mat-icon>close</mat-icon>
	</div>
	<div class="modal-task__title" [formGroup]="mockTaskData">
		<mat-icon>task</mat-icon>
		<h2 *ngIf="!headerTrigger"
			(click)="headerTrigger = !headerTrigger">{{mockTaskData.value.title}}</h2>
		<input *ngIf="headerTrigger"
			   formControlName="title"
			   (keyup.enter)="headerTrigger = !headerTrigger"
			   >
	</div>
	<div class="modal-task__status">
		<mat-icon>checklist</mat-icon>
		<p [matMenuTriggerFor]="statusMenu">Статус: {{mockTaskData.value.status}}</p>
		<mat-menu #statusMenu="matMenu">
			<button mat-menu-item 
					*ngFor="let status of mockStatusVariants"
					(click)="mockTaskData.value.status = status"
					[ngStyle]="{'color': mockTaskData.value.status == status ? 'orange' : 'black'}">
						{{status}}
					</button>
		</mat-menu>
	</div>
	<div class="modal-task__description">
		<mat-icon>description</mat-icon>
		<p>{{mockTaskData.value.description}}</p>
	</div>
	<div class="modal-task__text" [formGroup]="mockTaskData">
		<div formGroupName="text"
			 class="modal-task__text_wrp"
			 *ngFor="let item of mockTaskData.value.text; let i = index">
			<mat-icon [matMenuTriggerFor]="menu">more_vert</mat-icon>
			<mat-menu #menu="matMenu">
				<button mat-menu-item 
						*ngFor="let option of typeOptions"
						(click)="changeType(option, i)"
						[ngStyle]="{'color': item.type == option.type ? 'orange' : 'black'}">
							{{option.name}}
						</button>
			</mat-menu>
			<div class="modal_task__text_icon">
				<div *ngIf="item.type.length <= 0">
					<!-- <mat-icon>description</mat-icon> -->
				</div>
				<div *ngIf="item.type == 'todo'"
					 class="todo"
					 (click)="item.value = item.value == 'true' ? 'false' : 'true'">
					<mat-icon *ngIf="item.value == 'true'">check_box</mat-icon>
					<mat-icon *ngIf="item.value == 'false'">check_box_outline_blank</mat-icon>
				</div>
				<div *ngIf="item.type == 'ul'">
					●
				</div>
			</div>
			
			<div *ngIf="!inputTrigger"
				 (click)="inputTrigger = !inputTrigger"
				 class='modal-task__text_input_disabled'>
				{{item.text}}
			</div>
			<input class='modal-task__text_input' 
			   type='text'
			   value={{item.text}} 
			   *ngIf="inputTrigger"
			   name="inputTask"
			   (keyup.enter)="addText($event, i)"
			   (keyup.Delete)="deleteString(i)"
			>
		</div>
		<div class="modal-task__text_wrp">
			<mat-icon [matMenuTriggerFor]="addMenu">more_vert</mat-icon>
			<mat-menu #addMenu="matMenu">
				<button mat-menu-item 
						*ngFor="let option of typeOptions"
						(click)="changeType(option, -1)"
						[ngStyle]="{'color': createOption.type == option.type ? 'orange' : 'black'}">
							{{option.name}}
						</button>
			</mat-menu>
			<div class="modal_task__text_icon">
				<mat-icon>add</mat-icon>
			</div>
			<input class='modal-task__text_input_new' 
			   	   type='text'
			       name="inputTask"
			       (keyup.enter)="addText($event, -1)"
			>
		</div>
		
		<!-- <div class='modal-task__text_input_btns'
			 *ngIf="inputTrigger">
			<button mat-raised-button 
					color="primary" 
					(click)="inputTrigger = !inputTrigger"
			>
				Сохранить
			</button>
		</div> -->
		
	</div>
	<div class="modal-task__assignee">
		<div class="modal-task__assignee_line"></div>
		<div class="person-wrapper">
			<div class="modal-task__assigne_person" 
			 *ngFor="let person of mockTaskData.value.assignee">
				<img class="modal-task__assigne_person_avatar" *ngIf="!!person.avatar" [src]="person.avatar" alt="user pic" />
				<img class="modal-task__assigne_person_avatar" *ngIf="!person.avatar" src="assets/user-pic.jpeg" alt="user pic" />
				<div class="modal-task__assigne_person_name">
					{{person.name}}
				</div>
			</div>
			<div class="modal-task__assigne_add">
				<mat-form-field class="example-full-width" appearance="fill">
					<mat-label>Number</mat-label>
					<input type="text"
						   matInput
						   [formControl]="searchAssigneeQuery"
						   [matAutocomplete]="auto">
					<mat-autocomplete #auto="matAutocomplete">
					  <mat-option *ngFor="let option of filteredOptions | async" [value]="option">
						{{option.name}}
					  </mat-option>
					</mat-autocomplete>
				  </mat-form-field>
			</div>
		</div>
		
	</div>
</div>

